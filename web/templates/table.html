{{/* 1. The Main Table Shell (Only renders on offset 0) */}}
<table id="results-table" class="fide-table">
  <thead>
    <tr>
      {{range .Headers}}
      <th>{{.}}</th>
      {{end}}
    </tr>
  </thead>
  <tbody id="table-body">
    {{/* This calls the block below to fill the initial 20 rows */}}
    {{template "table-rows" .}}
  </tbody>
</table>

{{/* 2. OOB Update for the result count in index.html */}}
<span id="result-count" hx-swap-oob="true">
  {{if .TotalCount}} Found {{.TotalCount}} players {{end}}
</span>

{{/* 3. THE ROW BLOCK (This is what Go sends for "Load More") */}}
{{define "table-rows"}}
  {{range $row := .Rows}}
  <tr>
    {{range $h := $.Headers}}
    <td>{{index $row $h}}</td>
    {{end}}
  </tr>
  {{end}}

  {{/* The Load More Row replaces itself with new rows + a new button */}}
  {{if gt .TotalCount .NextOffset}}
  <tr id="load-more-row">
    <td colspan="5" style="text-align: center">
      <button
        hx-get="/search?search={{.Query}}&offset={{.NextOffset}}&sort={{.CurrentSort}}&dir={{.CurrentDir}}&fed={{.CurrentFed}}"
        hx-target="#load-more-row"
        hx-swap="outerHTML"
      >
        Load More...
      </button>
    </td>
  </tr>
  {{end}}
{{end}}
